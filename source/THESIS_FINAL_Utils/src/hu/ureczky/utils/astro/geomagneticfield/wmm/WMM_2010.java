package hu.ureczky.utils.astro.geomagneticfield.wmm;

// These coefficients and the formulae used below are from:
// NOAA Technical Report: The US/UK World Magnetic Model for 2010-2015
public class WMM_2010 implements WMM {
    
    private static final int BASE_YEAR = 2010; 
    
    private static final float[][] G_COEFF = new float[][] {
        {      0.0f },
        { -29496.6f, -1586.3f },
        {  -2396.6f,  3026.1f, 1668.6f },
        {   1340.1f, -2326.2f, 1231.9f,  634.0f },
        {    912.6f,   808.9f,  166.7f, -357.1f,   89.4f },
        {   -230.9f,   357.2f,  200.3f, -141.1f, -163.0f,  -7.8f },
        {     72.8f,    68.6f,   76.0f, -141.4f,  -22.8f,  13.2f, -77.9f },
        {     80.5f,   -75.1f,   -4.7f,   45.3f,   13.9f,  10.4f,   1.7f,   4.9f },
        {     24.4f,     8.1f,  -14.5f,   -5.6f,  -19.3f,  11.5f,  10.9f, -14.1f, -3.7f },
        {      5.4f,     9.4f,    3.4f,   -5.2f,    3.1f, -12.4f,  -0.7f,   8.4f, -8.5f, -10.1f },
        {     -2.0f,    -6.3f,    0.9f,   -1.1f,   -0.2f,   2.5f,  -0.3f,   2.2f,  3.1f,  -1.0f, -2.8f },
        {      3.0f,    -1.5f,   -2.1f,    1.7f,   -0.5f,   0.5f,  -0.8f,   0.4f,  1.8f,   0.1f,  0.7f,  3.8f },
        {     -2.2f,    -0.2f,    0.3f,    1.0f,   -0.6f,   0.9f,  -0.1f,   0.5f, -0.4f,  -0.4f,  0.2f, -0.8f, 0.0f }
    };

    private static final float[][] H_COEFF = new float[][] {
        {      0.0f },
        {      0.0f,  4944.4f },
        {      0.0f, -2707.7f, -576.1f },
        {      0.0f,  -160.2f,  251.9f, -536.6f },
        {      0.0f,   286.4f, -211.2f,  164.3f, -309.1f },
        {      0.0f,    44.6f,  188.9f, -118.2f,    0.0f, 100.9f },
        {      0.0f,   -20.8f,   44.1f,   61.5f,  -66.3f,   3.1f,  55.0f },
        {      0.0f,   -57.9f,  -21.1f,    6.5f,   24.9f,   7.0f, -27.7f,  -3.3f },
        {      0.0f,    11.0f,  -20.0f,   11.9f,  -17.4f,  16.7f,   7.0f, -10.8f,  1.7f },
        {      0.0f,   -20.5f,   11.5f,   12.8f,   -7.2f,  -7.4f,   8.0f,   2.1f, -6.1f,  7.0f },
        {      0.0f,     2.8f,   -0.1f,    4.7f,    4.4f,  -7.2f,  -1.0f,  -3.9f, -2.0f, -2.0f, -8.3f },
        {      0.0f,     0.2f,    1.7f,   -0.6f,   -1.8f,   0.9f,  -0.4f,  -2.5f, -1.3f, -2.1f, -1.9f, -1.8f },
        {      0.0f,    -0.9f,    0.3f,    2.1f,   -2.5f,   0.5f,   0.6f,   0.0f,  0.1f,  0.3f, -0.9f, -0.2f, 0.9f }
    };

    private static final float[][] DELTA_G = new float[][] {
        {      0.0f },
        {     11.6f,    16.5f },
        {    -12.1f,    -4.4f,    1.9f },
        {      0.4f,    -4.1f,   -2.9f,   -7.7f },
        {     -1.8f,     2.3f,   -8.7f,    4.6f,   -2.1f },
        {     -1.0f,     0.6f,   -1.8f,   -1.0f,    0.9f,   1.0f },
        {     -0.2f,    -0.2f,   -0.1f,    2.0f,   -1.7f,  -0.3f,   1.7f },
        {      0.1f,    -0.1f,   -0.6f,    1.3f,    0.4f,   0.3f,  -0.7f,   0.6f },
        {     -0.1f,     0.1f,   -0.6f,    0.2f,   -0.2f,   0.3f,   0.3f,  -0.6f,  0.2f },
        {      0.0f,    -0.1f,    0.0f,    0.3f,   -0.4f,  -0.3f,   0.1f,  -0.1f, -0.4f, -0.2f },
        {      0.0f,     0.0f,   -0.1f,    0.2f,    0.0f,  -0.1f,  -0.2f,   0.0f, -0.1f, -0.2f, -0.2f },
        {      0.0f,     0.0f,    0.0f,    0.1f,    0.0f,   0.0f,   0.0f,   0.0f,  0.0f,  0.0f, -0.1f,  0.0f },
        {      0.0f,     0.0f,    0.1f,    0.1f,   -0.1f,   0.0f,   0.0f,   0.0f,  0.0f,  0.0f,  0.0f, -0.1f, 0.1f }
    };

    private static final float[][] DELTA_H = new float[][] {
        {      0.0f },
        {      0.0f,   -25.9f },
        {      0.0f,   -22.5f,  -11.8f },
        {      0.0f,     7.3f,   -3.9f,   -2.6f },
        {      0.0f,     1.1f,    2.7f,    3.9f,   -0.8f },
        {      0.0f,     0.4f,    1.8f,    1.2f,    4.0f,  -0.6f },
        {      0.0f,    -0.2f,   -2.1f,   -0.4f,   -0.6f,   0.5f,   0.9f },
        {      0.0f,     0.7f,    0.3f,   -0.1f,   -0.1f,  -0.8f,  -0.3f,   0.3f },
        {      0.0f,    -0.1f,    0.2f,    0.4f,    0.4f,   0.1f,  -0.1f,   0.4f,  0.3f },
        {      0.0f,     0.0f,   -0.2f,    0.0f,   -0.1f,   0.1f,   0.0f,  -0.2f,  0.3f,  0.2f },
        {      0.0f,     0.1f,   -0.1f,    0.0f,   -0.1f,  -0.1f,   0.0f,  -0.1f, -0.2f,  0.0f, -0.1f },
        {      0.0f,     0.0f,    0.1f,    0.0f,    0.1f,   0.0f,   0.1f,   0.0f, -0.1f, -0.1f,  0.0f, -0.1f },
        {      0.0f,     0.0f,    0.0f,    0.0f,    0.0f,   0.0f,   0.1f,   0.0f,  0.0f,  0.0f,  0.0f,  0.0f, 0.0f }
    };

    ///////////////////////////////
    // GETTERS for the constants //
    ///////////////////////////////
    
    @Override public int getBaseYear() { return BASE_YEAR; }
    @Override public float[][] getGCoeff() { return G_COEFF; }
    @Override public float[][] getHCoeff() { return H_COEFF; }
    @Override public float[][] getDeltaG() { return DELTA_G; }
    @Override public float[][] getDeltaH() { return DELTA_H; }
    
    /** Testcases from http://www.ngdc.noaa.gov/geomag/WMM/data/WMM2010/WMM2010testvalues.pdf */
    public static float[][] TESTCASES = new float[][] {       
        //  Date,  Alt,  Lat,    Lon,        X,        Y,         Z,        H,        F,       I,      D
        //yyyy.y, [km], [deg], [deg],     [nT],     [nT],      [nT],     [nT],     [nT],   [deg],  [deg]  
        { 2010.0f,   0f,  80f,     0f,  6649.5f,  -714.6f,  54346.2f,  6687.8f, 54756.2f,  82.98f, -6.13f },
        { 2010.0f,   0f,   0f,   120f, 39428.8f,   664.9f, -11683.8f, 39434.5f, 41128.9f, -16.50f,  0.97f },
        { 2010.0f,   0f, -80f,   240f,  5657.7f, 15727.3f, -53407.5f, 16714.0f, 55961.8f, -72.62f, 70.21f },
        { 2010.0f, 100f,  80f,     0f,  6332.2f,  -729.1f,  52194.9f,  6374.0f, 52582.6f,  83.04f, -6.57f },
        { 2010.0f, 100f,   0f,   120f, 37452.0f,   611.9f, -11180.8f, 37457.0f, 39090.1f, -16.62f,  0.94f },
        { 2010.0f, 100f, -80f,   240f,  5484.3f, 14762.8f, -50834.8f, 15748.6f, 53218.3f, -72.79f, 69.62f },
        { 2012.5f,   0f,  80f,     0f,  6658.0f,  -606.7f,  54420.4f,  6685.5f, 54829.5f,  83.00f, -5.21f },
        { 2012.5f,   0f,   0f,   120f, 39423.9f,   608.1f, -11540.5f, 39428.6f, 41082.8f, -16.31f,  0.88f },
        { 2012.5f,   0f, -80f,   240f,  5713.6f, 15731.8f, -53184.3f, 16737.2f, 55755.7f, -72.53f, 70.04f },
        { 2012.5f, 100f,  80f,     0f,  6340.9f,  -625.1f,  52261.9f,  6371.6f, 52648.9f,  83.05f, -5.63f },
        { 2012.5f, 100f,   0f,   120f, 37448.1f,   559.7f, -11044.2f, 37452.2f, 39046.7f, -16.43f,  0.86f },
        { 2012.5f, 100f, -80f,   240f,  5535.5f, 14765.4f, -50625.9f, 15768.9f, 53024.9f, -72.70f, 69.45f }
    };
    
}